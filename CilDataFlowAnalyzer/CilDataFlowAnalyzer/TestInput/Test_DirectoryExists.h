#pragma once
#include "ITestInput.h"

class Test_DirectoryExists : public ITestInput
{
public:

	Test_DirectoryExists() = default;

	BYTE* GetTestBytes() override
	{
		return _testBytes;
	}

	int GetTestLength() override
	{
		return 100;
	}

private:

	BYTE* _testBytes = new BYTE[]
	{
		// Header - 12 bytes
		0x0B, 0x30, 0x01, 0x00, 0x30, 0x00, 0x00, 0x00, 0x12, 0x00, 0x00, 0x11,
		
		// Code - 48 bytes
		0x02,							// IL_0000	ldarg.0
		0x2D, 0x04,						// IL_0001	brtrue.s	0x04 ( IL_0007 )
		0x16,							// IL_0003	ldc.i4.0
		0x0B,							// IL_0004	stloc.1
		0xDE, 0x27,						// IL_0005	leave.s		0x27 ( IL_002E )
		0x02,							// IL_0007	ldarg.0
		0x6F, 0x24, 0x00, 0x00, 0x0A,	// IL_0008	callvirt	0x0A000024
		0x2D, 0x04,						// IL_000D	brtrue.s	0x04 ( IL_0013 )
		0x16,							// IL_000F	ldc.i4.0
		0x0B,							// IL_0010	stloc.1
		0xDE, 0x1B,						// IL_0011	leave.s		0x1B ( IL_002E )
		0x02,							// IL_0013	ldarg.0
		0x28, 0x48, 0x00, 0x00,	0x0A,	// IL_0014	call		0x0A000048
		0x0A,							// IL_0019	stloc.0
		0x06,							// IL_001A	ldloc.0
		0x28, 0x9F, 0x01, 0x00, 0x06,	// IL_001B	call		0x0600019F
		0x0B,							// IL_0020	stloc.1
		0xDE, 0x0B,						// IL_0021	leave.s		0x0B ( IL_002E )
		0x26,							// IL_0023	pop
		0xDE, 0x06,						// IL_0024	leave.s		0x06 ( IL_002C )
		0x26,							// IL_0026	pop
		0xDE, 0x03,						// IL_0027	leave.s		0x03 ( IL_002C )
		0x26,							// IL_0029	pop
		0xDE, 0x00,						// IL_002A	leave.s		0x00 ( IL_002C )
		0x16,							// IL_002C	ldc.i4.0
		0x2A,							// IL_002D	ret
		0x07,							// IL_002E	ldloc.1
		0x2A,							// IL_002F	ret

		// Extra Data Sections - 40 bytes
		0x01, 0x28, 0x00, 0x00,			// 4-byte header - SMALL format
		0x00, 0x00, 0x00, 0x00,	0x23, 0x23, 0x00, 0x03, 0x34, 0x00, 0x00, 0x01,	// Clause 0
		0x00, 0x00, 0x00, 0x00, 0x23, 0x26, 0x00, 0x03,	0x35, 0x00,	0x00, 0x01,	// Clause 1
		0x00, 0x00, 0x00, 0x00,	0x23, 0x29, 0x00, 0x03, 0x36, 0x00, 0x00, 0x01	// Clause 2
	};
};